/*
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
"use strict";!function(){function e(e,o){var t=e.split(o);return e=e.substr(t[0].length+o.length),[t[0],e]}function o(e,o,t){for(var a,n=0;n<e.length;n++)a=new RegExp(e[n],"g"),t=t.replace(a,o[n]);return t}async function t(e,o="info",t="white-text"){var a;"info"===o?(a="[INFO]",t="white-text"):"critical"===o?(a=W.critError,t="red-text"):"error"===o?(o="normal",a=W.logError,t="red-text"):"event"===o?(o="normal",a="[INFO]",t="blue-text"):"waiting"===o?(o="normal",a="[INFO]",t="yellow-text"):"success"===o?(o="normal",a="[INFO]",t="green-text"):"warning"===o?(o="normal",a="[WARNING]",t="yellow-text"):""===o?(a="",t="white-text"):"debug"===o?a="[DEBUG]":(a=o,o="message");let n=new Date,r=n.getHours(),i=n.getMinutes(),s=n.getSeconds(),l=(r<10?"0":"")+r+":"+(i<10?"0":"")+i+":"+(s<10?"0":"")+s;""!=a&&(a+=" ");let d=$("<span>");if(d.attr("class",t),L.push({type:o,content:d.html("["+l+"] "+a+e)[0].outerHTML+"<br>"}),"debug"===o&&!B)return;d.html(a+e);let c=$("#console");c.append(d),c.append("<br>"),c.scrollTop(c[0].scrollHeight-c.height())}function a(){W=U[z]||U.en;for(let[e,o]of Object.entries(J[z]||J.en))$("#"+e).html(o);$("#logsVerbosity").formSelect()}async function n(o=!0){$("#updateCommands").prop("disabled",!0),o&&t(W.updatingCommands,"waiting"),x={};for(var a=$("#commands").val(),n=a.split(/; *$/gm),r=[],i=0;i!==n.length-1;)n[i].endsWith("\\")&&r.push(n[i].substr(0,n[i].length-1)+";"+n[i+1])&&i++||r.push(n[i]),i++;for(var s of(n=r,r=void 0,n)){"\n"===s.charAt(0)&&(s=s.substr(1));var l=s.replace(/^(\$[A-Za-z0-9_]+) = (.+?)$/s,function(e,o,t){return E[o]=t,""});if(""!==l&&-1!==s.indexOf(" > ")){var d=e(s," > ");d[1]=d[1].replace(/\$[A-Za-z0-9_]+/g,function(e){return e in E?E[e]:e});var c=0==d[1].indexOf("photo "),u=!1,p=d[1].split(/\n/g),g=p[p.length-1];if(c){d[1]=e(d[1],"photo ")[1];var m="";-1!==d[1].indexOf("\n")&&(""!==(m=e(d[1],"\n")[1])&&-1===m.indexOf("[[[")&&-1===m.indexOf("(((")||m!==g)?(d[1]=e(d[1],m)[0],m=m.substring(0,m.lastIndexOf("\n"))):m=""}else 0===d[1].indexOf("sticker ")&&(d[1]=e(d[1],"sticker ")[1],u=!0);var b=null;if(0===g.indexOf("[[[")){b={inline_keyboard:[]},t("Building inline keyboard","debug");for(var h=/\[?(,? ?\[?(,? ?\[(.*?) - (.*?)\]?)\])\]?/g,f=0,v=0;k=h.exec(g);){if(y=0===k[4].indexOf("https://")||0===k[4].indexOf("http://")||0===k[4].indexOf("tg://")?{text:k[3],url:k[4]}:{text:k[3],callback_data:k[4]},t("Pushing <code>"+JSON.stringify(y)+"</code> into the keyboard array.","debug"),v++,v>1&&h.lastIndex<v)return t(W.regexpError,"critical"),void alert(W.critError+" "+W.regexpError);0===k[1].indexOf(", [[")||0===k[1].indexOf(",[[")||0===k[1].indexOf("[[")?(b.inline_keyboard.push([y]),f++):b.inline_keyboard[f-1].push(y)}t("Inline keyboard built.","debug"),d[1]=d[1].substring(0,d[1].lastIndexOf("\n"))}else if(0===g.indexOf("(((")){var f=0;b={keyboard:[]},t("Building traditional keyboard","debug");for(h=/\(?(,? ?\(?(,? ?\((.*?)\)?)\))\)?/g;k=h.exec(g);){var y={text:k[3]};t("Pushing <code>"+JSON.stringify(y)+"</code> into the keyboard array.","debug"),0===k[1].indexOf(", ((")||0===k[1].indexOf(",((")||0===k[1].indexOf("((")?(b.keyboard.push([y]),f++):b.keyboard[f-1].push(y)}(g.endsWith(",true")||g.endsWith(", true"))&&(b.one_time_keyboard=!0,t("One time keyboard detected","debug")),t("Keyboard built.","debug"),d[1]=d[1].substring(0,d[1].lastIndexOf("\n"))}else if(0===g.indexOf("()")){var k;b={remove_keyboard:!0},t("Remove keyboard put into reply_markup","debug"),d[1]=d[1].substring(0,d[1].lastIndexOf("\n"))}f=c?[d[1],"photo",b,m]:u?[d[1],"sticker",b]:[d[1],"text",b],d[0]in x?x[d[0]].push(f):x[d[0]]=[f]}}localStorage.setItem("commands",$("#commands").val()),o&&t(W.updatedCommands,"success"),$("#updateCommands").prop("disabled",!1)}function r(e){return $("<div>").text(e).html()}async function i(){y("getUpdates",{offset:S},async function(e){if("stop"==I)return $("#offlineWebhook").prop("checked")?(t(W.settingWebhook,"waiting"),y("setWebhook",{url:P+"?token="+T+"&lang="+z+"&d="+R},async function(){$("#startBot").prop("disabled",!1),t(W.botStopped,"event")},async function(e){t(W.errorWebhook+e.responseText,"error")})):($("#startBot").prop("disabled",!1),t(W.botStopped,"event")),I=0,!0;if(setTimeout(i,$("#ufUpdAnalyzer").prop("checked")?0:500),e.result!==[]&&e.result&&e.result.length>0){B&&(t("Received update "+r(JSON.stringify(e)),"debug"),D=(new Date).getTime(),t("Start Time: "+D,"debug"));for(let o of e.result)S=o.update_id,l(o);S++}0==I&&(localStorage.setItem("botToken",$("#token").val()),t(W.botStarted,"event"),t(W.helpCmd),$("#stopBot").prop("disabled",!1),y("getMe",{},async function(e){w=e.result,O=w.username;var a=["{BOTNAME}","{TMEBOTUSERNAME}"],n=[r(w.first_name),'<a href="tg://resolve?domain='+O+'">@'+O+"</a>"];t(o(a,n,W.botInfo))}),I=1)},async function(e){var o,a=e.responseText,n=JSON.parse(a),r=W.unknownError;(403==n.error_code||404==n.error_code?r=W.wrongToken:409==n.error_code&&(r=W.conflict),409===n.error_code&&"Conflict: can't use getUpdates method while webhook is active; use deleteWebhook to delete the webhook first"===n.description)?y("getWebhookInfo",{},async function(e){(0===e.result.url.indexOf(P)||confirm(W.unknownWebhook.format(e.result.url)))&&(y("deleteWebhook"),o=!0,I=0,$("#stopBot").prop("disabled",!1),$("#startBot").prop("disabled",!0),i(),t("Started updates loop","debug"))}):t(W.connectionError+r,"error");I=0,o||($("#stopBot").prop("disabled",!0),$("#startBot").prop("disabled",!1))})}async function s(){""!=T&&T&&(t("Updating bot settings...","debug"),localStorage.setItem("botSettings",JSON.stringify({parseMode:$("#parseMode").val(),wpPreview:$("#wpPreview").val(),autoStart:$("#autoStart").prop("checked"),logAllMsg:$("#logAllMsg").prop("checked"),ufUpdAnalyzer:$("#ufUpdAnalyzer").prop("checked"),selectedChatId:_,knownChatIDs:JSON.stringify(N),sendAll:$("#sendAll").prop("checked"),offlineWebhook:$("#offlineWebhook").prop("checked")})),t("Updated bot settings","debug"))}async function l(e){var a,n,i,s,l,d,u="",g=0,k="",w=!1,S=0;if("message"in e){if(B=e.message,!("chat"in B))return t(W.messageNotSupported,"warning"),!1;if(g=B.chat.id,"title"in B.chat&&(i=B.chat.title,w=!0),"from"in B&&("first_name"in B.from?(l=B.from.first_name,k=l):l="","last_name"in B.from?(s=B.from.last_name,k+=" "+s):s="",S="id"in B.from?B.from.id:0),n=void 0!==i?i:k,"text"in B)u=B.text,a="/"==u.charAt(0)&&-1!==u.indexOf("@"+O)?u.replace("@"+O,""):u;else if("photo"in B){var C=B.photo[B.photo.length-1].file_id,M=B.caption;(_==g||$("#logAllMsg").prop("checked"))&&y("getFile",{file_id:C},async function(e){var o="https://api.telegram.org/file/bot"+T+"/"+e.result.file_path;t('<span class="sentImg"><img src="'+o+'"><br>'+(M||"")+"</span>","["+(w?r(i)+": ":"")+r(k)+"]",_==g?"yellow-text":"white-text")},async function(e){e.responseText&&t(e.responseText,"error")}),u=""}else if("video"in B){M=B.caption;var E=B.video.file_id;(_==g||$("#logAllMsg").prop("checked"))&&y("getFile",{file_id:E},async function(e){var o="https://api.telegram.org/file/bot"+T+"/"+e.result.file_path;t('<span class="sentImg"><video src="'+o+'" controls></video><br>'+(M||"")+"</span>","["+(w?r(i)+": ":"")+r(k)+"]",_==g?"yellow-text":"white-text")},async function(e){e.responseText&&t(e.responseText,"error")}),u=""}else if("sticker"in B){E=B.sticker.file_id;(_==g||$("#logAllMsg").prop("checked"))&&y("getFile",{file_id:E},async function(e){var o="https://api.telegram.org/file/bot"+T+"/"+e.result.file_path;t('Sticker: <span class="sentImg"><img class="sticker" src="'+o+'"><br>'+(M||"")+"</span>","["+(w?r(i)+": ":"")+r(k)+"]",_==g?"yellow-text":"white-text")},async function(e){e.responseText&&t(e.responseText,"error")}),u=""}else if("voice"in B){M=B.caption,E=B.voice.file_id;(_==g||$("#logAllMsg").prop("checked"))&&y("getFile",{file_id:E},async function(e){var o="https://api.telegram.org/file/bot"+T+"/"+e.result.file_path;t('<span class="sentImg"><audio src="'+o+'" controls></audio><br>'+(M||"")+"</span>","["+(w?r(i)+": ":"")+r(k)+"]",_==g?"yellow-text":"white-text")},async function(e){e.responseText&&t(e.responseText,"error")}),u=""}else if("video_note"in B){M=B.caption,E=B.video_note.file_id;(_==g||$("#logAllMsg").prop("checked"))&&y("getFile",{file_id:E},async function(e){var o="https://api.telegram.org/file/bot"+T+"/"+e.result.file_path;t('<span class="sentImg"><video class="video_note" src="'+o+'" controls></video><br>'+(M||"")+"</span>","["+(w?r(i)+": ":"")+r(k)+"]",_==g?"yellow-text":"white-text")},async function(e){e.responseText&&t(e.responseText,"error")}),u=""}}else if("callback_query"in e){var I=e.callback_query,A=I.data,B=I.message,H=I.id,L=I.from;S=L.id;"first_name"in L&&(l=L.first_name),k=l,"last_name"in L&&(s=L.last_name,k+=" "+s),g=I.message.chat.id,"chat"in B&&(g=B.chat.id,"title"in B.chat&&(i=B.chat.title,w=!0)),n=void 0!==i?i:k,a=A,u=A,c(H),t("["+r(k)+"] Callback Data: "+A,"debug",_==S?"yellow-text":"white-text")}else u=W.messageNotSupported;_!=g&&!$("#logAllMsg").prop("checked")||void 0!==A||u&&t(r(u),"["+(w?r(i)+": ":"")+r(k)+"]",_==g?"yellow-text":"white-text"),N[g]=n,d=new Date((new Date).getTime()-D);var R=["{CHATID}","{USERID}","{CHATTITLE}","{NAME}","{FIRSTNAME}","{LASTNAME}","{MSGTEXT}","{HTMLESCAPEDMSGTEXT}","{STARTTIME}"],P=[g,S,"HTML"==$("#parseMode").val()?r(n):n,"HTML"==$("#parseMode").val()?r(k):k,"HTML"==$("#parseMode").val()?r(l):l,"HTML"==$("#parseMode").val()?r(s):s,u,r(u),d.getHours()-1+W.hours+d.getMinutes()+W.minutes+d.getSeconds()+W.seconds];if("/fileid"==M&&m(g,"FileID: <code>"+C+"</code>",null,!1,"HTML"),"/fileid"===a&&"reply_to_message"in B){var U=B.reply_to_message;if("photo"in U)E=U.photo[B.photo.length-1].file_id;else if("video"in U)E=U.video.file_id;else if("voice"in U)E=U.voice.file_id;else if("video_note"in U)E=U.video_note.file_id;else if("audio"in U)E=U.audio.file_id;else if("document"in U)E=U.document.file_id;else if("sticker"in U)E=U.sticker.file_id;else E="Not available or not compatible";m(g,"File ID: <code>"+E+"</code>",null,!1,"HTML")}if(a in x&&""!=a)for(var J of x[a]){var z=null;if($("#sendAll").prop("checked")||(J=x[a][Math.floor(Math.random()*x[a].length)],z=x[a][0][2]),"text"==J[1]){var F=o(R,P,J[0]);t("Text to send: "+r(F),"debug"),2 in J&&J[2]&&(z=J[2],z=JSON.stringify(z),z=o(R,P,z),z=JSON.parse(z)),void 0!==A?$.isEmptyObject(z)||"inline_keyboard"in z?"photo"in B?(t("Message to edit is a photo. Incompatible types photo, text. Deleting previous message and sending a new one.","debug"),p(g,B.message_id),m(g,F,z)):"sticker"in B?(t("Message to edit is a sticker. Incompatible types sticker, text. Deleting previous message and sending a new one.","debug"),p(g,B.message_id),m(g,F,z)):b(g,F,B.message_id,z):(t("reply_markup is not an inline keyboard and request has been sent by a button, sending a new message and deleting the existing one.","debug"),p(g,B.message_id),m(g,F,z)):m(g,F,z)}else if("photo"==J[1]){M="";var G=null;3 in J&&(M=o(R,P,J[3]),t("Caption to send: "+r(M),"debug")),2 in J&&J[2]&&(z=J[2],z=JSON.stringify(z),z=o(R,P,z),z=JSON.parse(z)),void 0!==A?$.isEmptyObject(z)||"inline_keyboard"in z?"text"in B?(t("Message to edit is a text. Incompatible types photo, text. Deleting previous message and sending a new one.","debug"),p(g,B.message_id),f(g,J[0],M,z)):"sticker"in B?(t("Message to edit is a sticker. Incompatible types photo, sticker. Deleting previous message and sending a new one","debug"),p(g,B.message_id),f(g,J[0],M,z)):(G={type:"photo",media:J[0],caption:M},h(g,B.message_id,G,z)):(t("reply_markup is not an inline keyboard and request has been sent by a button, sending a new message and deleting the existing one.","debug"),p(g,B.message_id),f(g,J[0],M,z)):f(g,J[0],M,z)}else"sticker"==J[1]&&(2 in J&&J[2]&&(z=J[2],z=JSON.stringify(z),z=o(R,P,z),z=JSON.parse(z)),void 0!==A&&(p(g,B.message_id),t("Can't edit sticker.","debug")),v(g,J[0],z));if(!$("#sendAll").prop("checked"))break}if("any"in x&&void 0===A)for(var J of x.any){if($("#sendAll").prop("checked")||(J=x.any[Math.floor(Math.random()*x.any.length)]),"text"==J[1]){F=o(R,P,J[0]);t("Text to send: "+r(F),"debug");z={};2 in J&&(z=J[2]),m(g,F,z)}else if("photo"==J[1]){M="";2 in J&&(M=o(R,P,J[2]),t("Caption to send: "+r(M),"debug")),f(g,J[0],M)}if(!$("#sendAll").prop("checked"))break}t("Response Time: "+((new Date).getTime()-D)+"ms","debug")}async function d(o){if(""!=T&&T&&1==I)switch(e(o," ")[0]){case"/help":t(W.helpConsoleCommands,"");break;case"/select":var a=e(o," ");if(1 in a&&a[1])_=a[1],t(0==_?W.removedChatIdSelection:W.selected+_+"!","success"),s();else if($.isEmptyObject(N))t(W.noKnownChats,"error");else{var n="";for(var i in N)n+='<option value="'+i+'"'+(i==_?" selected":"")+">"+r(N[i])+"</option>";$("#selectChatId").html(n).formSelect(),$("#selectChatIdModal").modal("open")}break;default:"/"==o.charAt(0)?t(W.unknownCommand,"error"):0!=_?(o=o.replace(/\\n/g,"\n"),o.replace(new RegExp(" ","g"),"").length>0?o.length<=4096?m(_,o,{},!0):t(W.messageTooLong,"error"):t(W.emptyMessage,"error")):t(W.noChatSelected,"error")}else t(W.consoleBotNotStarted,"error")}async function c(e,o,t){var a={callback_query_id:e,text:o,show_alert:t};y("answerCallbackQuery",a)}async function u(){$.ajax({url:"https://easyjsbot.pato05mc.tk/protectedtransfer.php",async:!0,method:"POST",data:{url:R,lang:z},dataType:"json",success:e=>{1!=e.isLegit&&$("body > main > div.container > div.card-panel").prepend($("<div>").addClass("row").html(e.prep))},error:()=>{t("Security check failed. Please, contact @Pato05 on Telegram","warning")}})}async function p(e,o){var a={chat_id:e,message_id:o};y("deleteMessage",a,async function(){},async function(e){var a=e.responseText;t(W.deleteMessageError+o+": "+a,"error")},!0)}async function g(e,o){var t={chat_id:e,action:o};y("sendChatAction",t)}async function m(e,o,a=null,n=!1,i=!1,s=!1){if(i||(i=$("#parseMode").val()),s||(s=$("#wpPreview").val()),null!=e&&""!=e||e){var l={chat_id:e,text:o,parse_mode:i,disable_web_page_preview:s};return a&&(l.reply_markup=JSON.stringify(a)),y("sendMessage",l,async function(o){n&&t(o.result.text,"["+W.messageSent+r(e in N?N[e]:e)+"]","green-text")},async function(e){var o=e.responseText;t(W.sendMessageError+o,"error")},!0),!0}return!1}async function b(e,o,a,n=null,r=!1,i=!1,s=!1){if(i||(i=$("#parseMode").val()),s||(s=$("#wpPreview").val()),!(null!=e&&""!=e||e))return!1;var l={chat_id:e,text:o,parse_mode:i,message_id:a,disable_web_page_preview:s};n&&(l.reply_markup=JSON.stringify(n)),y("editMessageText",l,async function(){},async function(e){var o=e.responseText;t(W.sendMessageError+o,"error")},!0)}async function h(e,o,a,n=null,r=!1){if(r||(r=$("#parseMode").val()),!(null!=e&&""!=e||e))return!1;"parse_mode"in a||(a.parse_mode=r);var i={chat_id:e,message_id:o,media:JSON.stringify(a)};n&&(i.reply_markup=JSON.stringify(n)),y("editMessageMedia",i,async function(){},async function(e){var o=e.responseText;t(W.sendMessageError+o,"error")},!0)}async function f(e,o,a="",n=null,r=!1,i=!1,s=!1){i||(i=$("#parseMode").val()),s||(s=$("#wpPreview").val());var l={chat_id:e,photo:o,caption:a,parse_mode:i,disable_web_page_preview:s};n&&(l.reply_markup=JSON.stringify(n)),y("sendPhoto",l,async function(a){r&&y("getFile",{file_id:o},async function(o){var a="https://api.telegram.org/file/bot"+T+"/"+o.result.file_path;t('<span class="sentImg"><img src="'+a+'"></span>',"["+W.messageSent+": "+(e in N?N[e]:e)+"]","green-text")},async function(e){e.responseText&&t(e.responseText,"error")})},async function(e){var o=e.responseText;t(W.sendMessageError+o,"error")},!0)}async function v(e,o,t=null){var a={chat_id:e,sticker:o};t&&(a.reply_markup=JSON.stringify(t)),y("sendSticker",a)}async function y(e,o={},a=async function(){},n=async function(){},i=!0){"getUpdates"!==e&&t("Doing a "+e+' method request with POST args "'+r(JSON.stringify(o))+'"...',"debug"),$.ajax({url:"https://api.telegram.org/bot"+T+"/"+e,async:i,method:"POST",data:o,dataType:"json",success:a,error:n}),"getUpdates"!==e&&t("Request of type "+e+" ended.","debug")}function k(e="debug"){let o="";""===e?e=0:"normal"===e?e=1:"debug"===e&&(e=2);for(let t of L)e>0&&("normal"===t.type&&(o+=t.content),e>1&&"debug"===t.type&&(o+=t.content)),("critical"===t.type||"message"===t.type)&&(o+=t.content);return o}var w,T="",S=-1,C=localStorage,x={},E={},I=0,_=0,A="",O="",N={},B=!1,H=0,D=(new Date).getTime(),L=[];const R=document.location.href,P="https://easyjsbot.pato05mc.tk/offline.php";var U={it:{startingBot:"Avviando il bot... Connessione in corso ai server telegram...",botIsRunning:"Il bot è attivo. Clicca Arresta prima di uscire dalla pagina, per favore.",emptyToken:"Bot non avviato! Bot token vuoto!",stopSent:"Richiesta di arresto inviata!",autoStart:"Bot in avvio secondo le tue impostazioni...",userDidntStartBot:"L'utente selezionato precedentemente ha bloccato il bot o non lo ha mai avviato.",unknownError:"Errore sconosciuto",autoSelectCID1:"Selezionata chat ",autoSelectCID2:" come da sessione precedente.",updatingCommands:"Aggiornamento lista comandi in corso...",updatedCommands:"Aggiornamento lista comandi completato!",botStopped:"Bot arrestato!",botStarted:"Bot avviato! Attenzione: Se chiudi questa pagina, verrà anche arrestato il tuo bot!",helpCmd:"/help per i comandi della console.",botInfo:"Info Bot:<br>Nome: {BOTNAME}<br>Username: {TMEBOTUSERNAME}",wrongToken:"Token errato o non valido",conflict:"Conflitto, il bot ha il webhook già settato, oppure qualche altro programma è sul bot",connectionError:"Errore nella connessione: ",messageNotSupported:"Messaggio non supportato",sendMessageError:"Errore nell'invio del messaggio: ",helpConsoleCommands:"Menù comandi:<br />/help: visualizza questo menù di aiuto<br />/select: GUI per selezionare la chat in cui inviare i messaggi<br />&lt;messaggio&gt;: invia messaggio nella chat_id selezionata",removedChatIdSelection:"Rimossa selezione chat_id!",selected:"Selezionato ",noKnownChats:"Nessun chat_id conosciuto. Impossibile mostrare la GUI. Seleziona un chat_id manualmente con /select &lt;chat_id&gt;",unknownCommand:"Comando sconosciuto. /help per una lista completa di comandi.",messageTooLong:"Messaggio troppo lungo. Caratteri massimi consentiti: 4096 caratteri.",emptyMessage:"Messaggio nullo.",noChatSelected:"Per favore, prima di tentare di inviare un messaggio, usa /select",consoleBotNotStarted:'Prima di scrivere comandi, perfavore, metti il token del bot. Se lo hai già fatto, assicurati di aver avviato il bot cliccando il pulsante "Avvia"',messageSent:"Messaggio inviato: ",logError:"[ERRORE]",deleteMessageError:"Impossibile eliminare il messaggio ",regexpError:"Impossibile costruire la tastiera: l'espressione regolare non va avanti. Per favore, prova ad aggiornare il tuo browser, oppure avvia un'issue su Github",critError:"[ERRORE CRITICO]",hours:" ore ",minutes:" minuti ",seconds:" secondi ",settingWebhook:"Sto impostando il webhook...",botStoppedWebhookSet:"Bot arrestato e webhook settato!",errorWebhook:"Errore durante l'imposto del webhook: ",unknownWebhook:"C'è un webhook già impostato che non punta alla pagina offline.\n{0}\nVuoi rimuoverlo?"},en:{startingBot:"Starting the bot... Connecting to telegram servers...",botIsRunning:"Bot is still running. Please, click Stop before leaving the page.",emptyToken:"Bot not started! Bot token empty!",stopSent:"Stop request sent!",autoStart:"Starting the bot according to your settings...",userDidntStartBot:"The user previously selected has blocked the bot or he hasn't started it at all.",unknownError:"Unknown error",autoSelectCID1:"Selected chat ",autoSelectCID2:" as previous session.",updatingCommands:"Updating commands list...",updatedCommands:"Commands list updated!",botStopped:"Bot stopped!",botStarted:"Bot started! Warning: If you close this page, your bot will be stopped too!",helpCmd:"/help for the console commands.",botInfo:"Bot Info:<br>Name: {BOTNAME}<br>Username: {TMEBOTUSERNAME}",wrongToken:"Wrong token or token not valid",conflict:"Conflict, the bot has already setted webhook, or some other program is on the bot",connectionError:"Connection error: ",messageNotSupported:"Messsage not supported",sendMessageError:"Message sending error: ",helpConsoleCommands:"Commands menù:<br />/help: shows this help menu<br />/select: GUI to select chat to send messages in<br />&lt;messaggio&gt;: send message in selected chat",removedChatIdSelection:"Removed chat_id selection!",selected:"Selected ",noKnownChats:"No known chat_id. Unable to show the GUI. Select a chat_id manually with /select &lt;chat_id&gt;",unknownCommand:"Unknown command. /help for a commands list.",messageTooLong:"Message too long. Maximum allowed characters: 4096 characters.",emptyMessage:"Message empty.",noChatSelected:"Please, before trying to send a message, use /select",consoleBotNotStarted:'Before typing commands, enter the bot token. If you have already done it, make sure you\'ve clicked the "Start" button',messageSent:"Message sent: ",logError:"[ERROR]",deleteMessageError:"Can't delete message ",regexpError:"Can't build keyboard: Regexp not going forward. Please update your browser or put an issue on Github.",critError:"[CRITICAL ERROR]",hours:" hours ",minutes:" minutes ",seconds:" seconds ",settingWebhook:"Setting the webhook...",botStoppedWebhookSet:"Bot stopped and webhook set!",errorWebhook:"Error while setting the webhook: ",unknownWebhook:"There is a webhook already set that doesn't point to the offline page.\n{0}\nDo you want to remove it?"}},J={it:{commandsHelpTr:"/comando > Risposta<strong>;</strong>(se devi usare il punto e virgola, poi ritornare a capo, metti un \\ prima del ;. Esempio: <code>/start > Ciao\\;;</code>, invierà Ciao;)<br>        Nella risposta, puoi usare <strong>photo</strong> oppure <strong>sticker</strong> seguito da un <strong>file_id/url</strong> (per mettere la descrizione alla foto, vai a capo) per inviare una foto, o un semplice testo per inviare una risposta testuale.<br>        Saranno aggiunti altri tipi di documenti/video presto.<br>        Per ricevere il file_id di una foto, manda una foto al tuo bot con descrizione /fileid        <br><br>        Nella risposta testuale puoi usare i seguenti codici:<br>        <code>{CHATID}</code>, <code>{USERID}</code>, <code>{CHATTITLE}</code>, <code>{NAME}</code>, <code>{FIRSTNAME}</code>, <code>{LASTNAME}</code>, <code>{MSGTEXT}</code>, <code>{HTMLESCAPEDMSGTEXT}</code>, <code>{STARTTIME}</code>        <br>        <code>{CHATID}</code>: ID della chat<br>        <code>{USERID}</code>: ID utente<br>        <code>{CHATTITLE}</code>: Nel caso di un gruppo, il nome del gruppo, altrimenti il nome completo dell'utente<br>        <code>{NAME}</code>: Nome completo dell'utente<br>        <code>{FIRSTNAME}</code>: Nome dell'utente<br>        <code>{LASTNAME}</code>: Cognome dell'utente<br>        <code>{MSGTEXT}</code>: Testo messaggio inviato.<br>        <code>{HTMLESCAPEDMSGTEXT}</code>: Testo messaggio inviato escapato da HTML.        <code>{STARTTIME}</code>: Ore, minuti e secondi formattati basandosi sulla tua lingua.        <br><br>        Mettendo <code>any</code> come comando, questo risponderà ad ogni comando.        <br><br>        Puoi usare le tastiere inline mettendo sull'ultima linea della risposta al tuo comando <strong>[[[BOTTONE - COMANDO]]]</strong> e, una virgola prima dell'ultima parentesi quadra per mettere un altro bottone sull'altra linea della tastiera inline.        <br><code>[[[Bottone1 - comando1]],[[Bottone2 - comando2]]]</code>        <br>oppure, una virgola sulla parentesi direttamente successiva a COMANDO per un bottone sulla stessa linea        <br><code>[[[Bottone - comando],[Sono sulla stessa linea! - comando2]]]</code>        <br>Per rispondere ad un bottone cliccato, metti il callback data messo nel bottone come un normale comando        <code>comando1 > risposta1;</code> Il messaggio sarà modificato con risposta1        <br><br>Esempio pratico:<br>        <code>/start > Ciao! Clicca uno dei bottoni qui sotto:        <br>[[[Cosa fai? - //help],[Come sei stato creato? - //creato]],[[Ciao! - //saluto]]];        <br>//help > Non faccio niente :);        <br>//creato > Sono stato creato con EasyJSBot!;        <br>//saluto > Ciao!;</code><br><br>        <br>Puoi anche usare le tastiere tradizionali, la sintassi è (((RISPOSTA))) come con le tastiere inline, puoi ordinarle come vuoi:        <br><code>(((Ciao),(Come va?)))</code>: Ciao e Come va? saranno sulla stessa linea         <br><code>(((Ciao)),((Come va?)))</code>: Ciao e Come va? Saranno questa volta su linee diverse        <br>Facendo così, creerai una tastiera permanente, che si può rimuovere mettendo sulla risposta () che rimuoverà la tastiera        <br>Oppure, per nasconderla (necessiterai successivamente di rimuoverla), potrai mettere \", true\" alla fine delle parentesi <code>(((Ciao))), true</code> che creerà una        \"one time keyboard\" cioè, una tastiera che verrà nascosta automaticamente al click del bottone.        <br><br>Esempio pratico:<br>        <code>/start > Ciao, benvenuto sul bot. Clicca uno dei pulsanti:<br>        (((Come sei stato creato?),(Cosa puoi fare?)),((Ciao!)),((Rimuovi la tastiera)));<br>        Come sei stato creato? > Sono stato creato con EasyJSBot;<br>        Cosa puoi fare? > Niente, sono solo di test;<br>        Ciao! > Ciao!!;<br>        Rimuovi la tastiera > Ok! Invia /start se hai bisogno ancora di me!<br>        ();</code>        <br>Puoi usare anche le variabili: si dichiarano con $variabile = valore; Ex: <code>$saluto = Ciao!;</code>, e si possono usare dove        vuoi nella risposta, come keyboard inline, come keyboard tradizionali, ecc. <br>        I nomi delle variabili possono contenere i caratteri 0-9, A-Z, a-z e _. Qualsiasi altro carattere non è accettato e la variabile verrà ignorata.","tr-botToken":"Token del bot","tr-botcommands":"Comandi del bot",startBot:"Avvia!",stopBot:"Arresta","tr-autostart":"Avvia automaticamente il bot al caricamento della pagina","tr-logallmsg":"Logga i messaggi da qualsiasi chat","tr-createdby":"Creato da Pato05 <code>:)</code>","tr-cmdHelpTitle":"Help comandi",selectChId:"Seleziona la chat_id",removeChatId:"Rimuovi selezione","tr-all":"Invia tutti i messaggi","tr-random":"Messaggio casuale","tr-wh":"Invia un messaggio quando il bot è offline",downloadLogs:"Scarica i log",downloadLogsText:"Come un file di testo",downloadLogsHTML:"Come un file HTML","tr-onlymsgs":"Solo messaggi","tr-normallog":"Normale","lbl-logsVerbosity":"Livello di verbosità dei logs","tr-dlJS":"Tutti i livelli (solo HTML)"},en:{"tr-botToken":"Bot Token","tr-botcommands":"Bot commands",startBot:"Start!",stopBot:"Stop","tr-autostart":"Automatically start the bot at page load","tr-logallmsg":"Log messages from every chat","tr-createdby":"Created by Pato05 <code>:)</code>","tr-cmdHelpTitle":"Commands Help",selectChId:"Select the chat_id",removeChatId:"Remove selection",commandsHelpTr:"/command > Answer<strong>;</strong> (if you have to use the semicolon, then return, put a \\ before ;. Example: <code>/start > Hello\\;;</code>, it will send Hello;)<br>        In the answer, you can use <strong>photo</strong> or <strong>sticker</strong> followed by <strong>file_id/url</strong> (to put the caption to a photo, start a new line) to send a photo, or a simple text to send a textual answer.<br>        Will be added new types of documents/videos soon (I'm too lazy to do it now.)<br>        To get a photo file_id, send a photo to your active bot with caption /fileid        <br><br>        In the textual answer or caption you can use these codes:<br>        <code>{CHATID}</code>, <code>{USERID}</code>, <code>{CHATTITLE}</code>, <code>{NAME}</code>, <code>{FIRSTNAME}</code>, <code>{LASTNAME}</code>, <code>{MSGTEXT}</code>, <code>{HTMLESCAPEDMSGTEXT}</code>, <code>{STARTTIME}</code>        <br>        <code>{CHATID}</code>: Chat ID<br>        <code>{USERID}</code>: User ID<br>        <code>{CHATTITLE}</code>: In the case of a group, the group title, else the complete user's name<br>        <code>{NAME}</code>: Complete user's name<br>        <code>{FIRSTNAME}</code>: User's first name<br>        <code>{LASTNAME}</code>: User's last name<br>        <code>{MSGTEXT}</code>: Text of the message sent by the user<br>        <code>{HTMLESCAPEDMSGTEXT}</code>: Text of the message sent by the user HTML escaped.        <code>{STARTTIME}</code>: Ore, minuti e secondi formattati basandosi sulla tua lingua.        <br><br>        Putting <code>any</code> as command, it will answer to each message.        <br><br>        You can use inline keyboards by putting at the end of your answer <strong>[[[BUTTON - COMMAND]]]</strong> and, a virgola before the last bracket to put a button on a new line.        <br><code>[[[Button1 - command1]],[[Button2 - Command2]]]</code>        <br>or, a virgola after the bracket directly next at COMMAND for a button on the same line        <br><code>[[[Button - command],[I'm on the same line! - command2]]]</code>        <br>To answer a clicked button, put your button command like a normal command        <code>command1 > answer1;</code> The message will be edited with answer1        <br><br>Pratical example:<br>        <code>/start > Hello! Click one of the buttons below:        <br>[[[What do you do? - //help],[How have you been created? - //created]],[[Hi! - //greeting]]];        <br>//help > I don't do nothing :);        <br>//created > I have been created with EasyJSBot!;        <br>//greeting > Hello there!;</code><br><br>        <br>You can use traditional keyboards too, the syntax is (((ANSWER))) and, like as inline keyboards, you can order them as you wish:        <br><code>(((Hello),(How are you?)))</code>: Hello and How are you? will be on the same line        <br><code>(((Ciao)),((Come va?)))</code>: Hello and How are you? will now be on different lines        <br>Doing that you'll create a permanent keyboard, that can be removed with () in the last line of the answer        <br>Or, to hide it (you will equally need to remove it after), if you put \", true\" at the end of the brackets <code>(((Ciao))), true</code> it will create a        \"one time keyboard\", a keyboard that will be hided when a button is clicked.        <br><br>Pratical example:<br>        <code>/start > Hello, welcome to the bot. Click one of the buttons:<br>        (((How have you been created?),(What can you do?)),((Hello!)),((Remove keyboard)));<br>        How have you been created? > I've been created with EasyJSBot;<br>        What can you do? > Nothing, I am only for testing;<br>        Hello! > Hello there!!;<br>        Remove keyboard > Ok! Send again /start if you need me!<br>        ();</code>        <br>You can use variables: you can declare them by $variable = value; Ex: <code>$greeting = Hello!;</code>, and you can use them everywhere        in the command response, as inline keyboard, as traditional keyboard, etc. <br>        Variable names can contain the characters 0-9, A-Z, a-z and _. If you use every other character, the variable will be ignored.","tr-all":"Send all messages","tr-random":"Random message","tr-wh":"Send a message when the bot is offline",downloadLogs:"Download Logs",downloadLogsText:"As a text file",downloadLogsHTML:"As an HTML file","tr-onlymsgs":"Only messages","tr-normallog":"Normal","lbl-logsVerbosity":"Logs verbosity level","tr-dlJS":"Every level (only HTML)"}};String.prototype.format=function(){let e=this;for(let o in arguments)e=e.replace("{"+o+"}",arguments[o]);return e};var W,z=(navigator.userLanguage||navigator.language).substr(0,2);$(document).ready(async function(){if(void 0===R&&R!==document.location.href&&t("Variable not set.","critical"),-1!==location.href.indexOf("#")){var e=location.hash;"#debug=1"==e&&(B=!0,setTimeout(function(){t("DEBUG mode enabled","debug")},0))}if($("#applyChatId").on("click",async function(){d("/select "+$("#selectChatId").val())}),$("#removeChatId").on("click",async function(){d("/select 0")}),$("#autoStart").on("change",s),$("#logAllMsg").on("change",s),$("#parseMode").on("change",s),
$("#wpPreview").on("change",s),$("#ufUpdAnalyzer").on("change",s),$("#sendAll").on("change",s),$("#offlineWebhook").on("change",s),$("#consoleCommandsGo").click(function(){let e=$("#consoleCommands");e.val().replace(/\\n/g,"\n");A=e.val(),d(e.val()),e.val("")}),$("#consoleCommands").focus(async function(){$("#consoleCommandsContainer").css("background","rgb(15, 15, 15)")}),$("#consoleCommands").blur(async function(){$("#consoleCommandsContainer").css("background","#000")}),$(window).on("beforeunload",function(){if(0!=I)return W.botIsRunning}),$("#consoleCommands").keyup(async function(e){if(13==e.keyCode)$("#consoleCommandsGo").click(),H=0;else if(38==e.keyCode)$(this).val(A);else if(0!=I&&0!==_){let e=Math.round((new Date).getTime()/1e3);e-H>5&&(g(_,"typing"),H=e)}}),$("#startBot").click(function(){0==I?void 0!==R||R===document.location.href?(T=$("#token").val(),""!=T&&T?($("#startBot").prop("disabled",!0),t(W.startingBot,"event"),i(),t("Started updates loop","debug")):t(W.emptyToken,"error")):t("Variable not set. Please, contact @Pato05 on Telegram.","critical"):console.log("Don't mess with me ;)")}),$("#stopBot").click(async function(){0!=I&&"stop"!=I?(I="stop",$("#stopBot").prop("disabled",!0),t(W.stopSent,"waiting")):console.log("Don't mess with me ;)")}),$("#downloadLogsText").click(async function(e){e.preventDefault();let o=new Date,t=k("jsHTML"===$("#logsVerbosity").val()?"debug":$("#logsVerbosity").val()),a=t.replace(/<img(.+?)>/g,"Immagine").replace(/<video(.+?)class="video_note"(.+?)<\/video>/g,"Nota video").replace(/<video(.+?)<\/video>/g,"Video").replace(/<audio(.+?)<\/audio>/g,"Messaggio vocale").replace(/<span(.+?)>/g,"").replace(/(<br( \/)?>)?<\/span>/g,"").replace(/<br( \/)?>/g,"\n");console.log(a);let n=$("<a>").prop("href","data:application/octet-stream;charset=utf-8,"+encodeURIComponent($("<div>").html(a).text())).prop("download","easyjsbot-"+o.getHours()+o.getMinutes()+o.getSeconds()+o.getDay()+o.getMonth()+o.getFullYear()+".log").css("display","none");$("body").append(n),n[0].click(),n.remove()}),$("#downloadLogsHTML").click(async function(e){e.preventDefault();let o=".sentImg>video.video_note{border-radius:50%;min-width:60%;min-height:60%;}.sentImg,.sentImg>img{display:inline-block;max-width:100%;max-height:30%;text-align:center}html,body{color:#fff;background-color:#000;font-family:Roboto,Montserrat,Lato,sans-serif;padding:15px;}a{text-decoration:none;color:#039be5;-webkit-tap-highlight-color:transparent;}.yellow-text{color:#ffeb3b}.blue-text{color:#2196F3}.red-text{color:#F44336}.green-text{color:#4CAF50}.white-text{color:#fff}",t='<html><head><!-- Generated by EasyJSBot (https://github.pato05mc.tk/tg-js-bot) --><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, shrink-to-fit=no"><meta name="generator" content="EasyJSBot Log"><title>EasyJSBot Log {0}</title><style>{1}</style></head><body>{2}</body></html>',a=new Date,n=a.getDay(),r=a.getMonth(),i=a.getFullYear(),s=$("#logsVerbosity").val(),l="",d=(n<10?"0":"")+n+"/"+(r<10?"0":"")+r+"/"+i;if("jsHTML"===s){let e="let logs="+JSON.stringify(L)+';!function(){const e=function(){let e=document.getElementById("logs");e.innerHTML="";let n=this.value;""===n?n=0:"normal"===n?n=1:"debug"===n&&(n=2);for(let t of logs)n>0&&("normal"===t.type&&(e.innerHTML+=t.content),n>1&&"debug"===t.type&&(e.innerHTML+=t.content)),("critical"===t.type||"message"===t.type)&&(e.innerHTML+=t.content)};document.getElementById("verbositySelect").addEventListener("change",e),e()}();';o+="#verbositySelect{position:fixed;height:30px;width:150px;border:.1px solid #fff;top:0;right:0;background-color:#000;color:#fff;}select:focus{outline:none}",l=t.format(d,o,'<select id="verbositySelect"><option value="" selected="">'+J[z]["tr-onlymsgs"]+'</option><option value="normal">'+J[z]["tr-normallog"]+'</option><option value="debug">Debug</option></select><div id="logs"></div><script>// Generated by EasyJSBot\n'+e+"</script>")}else{let e=k(s);l=t.format(d,o,e)}let c=$("<a>").prop("href","data:application/octet-stream;charset=utf-8,"+encodeURIComponent(l)).prop("download","easyjsbot-"+a.getHours()+a.getMinutes()+a.getSeconds()+n+r+i+".log.html").css("display","none");$("body").append(c),c[0].click(),c.remove()}),$("#langIT").click(async function(e){e.preventDefault(),z="it-IT",a()}),$("#langEN").click(async function(e){e.preventDefault(),z="en",a()}),$("#commands").blur(async function(){n(!0)}),a(),$("#updateCommands").click(n),"commands"in C?($("#commands").val(C.commands),-1!==C.commands.indexOf("///////////")&&($("#commands").val($("#commands").val().split("///////////").join("\n")),n())):$("#commands").val("/start > Messaggio di avvio!;\n/help > Menù di aiuto!;"),"botToken"in C&&($("#token").val(C.botToken),T=$("#token").val()),"botSettings"in C){var o=JSON.parse(C.botSettings);"parseMode"in o&&$("#parseMode").val(o.parseMode),"wpPreview"in o&&$("#wpPreview").val(o.wpPreview),"autoStart"in o&&($("#autoStart").prop("checked",o.autoStart),1==o.autoStart&&setTimeout(function(){t(W.autoStart,"waiting"),""!=T&&T?$("#startBot").click():(t(W.emptyToken,"error"),$("#autoStart").prop("checked",!1),s())},0)),"logAllMsg"in o&&$("#logAllMsg").prop("checked",o.logAllMsg),"knownChatIDs"in o&&(N=JSON.parse(o.knownChatIDs)),"ufUpdAnalyzer"in o&&$("#ufUpdAnalyzer").prop("checked",o.ufUpdAnalyzer),"sendAll"in o&&$("#sendAll").prop("checked",o.sendAll),"offlineWebhook"in o&&$("#offlineWebhook").prop("checked",o.offlineWebhook),"selectedChatId"in o&&0!=o.selectedChatId&&setTimeout(async function(){_=o.selectedChatId,!_ in N?y("getChat",{chat_id:_},function(e){},async function(e){let o=JSON.parse(e.responseText),a=o.error_code;o.description;t(403==a?W.userDidntStartBot:W.unknownError+": "+JSON.stringify(o),"error"),_=""}):t(W.autoSelectCID1+r(N[_])+W.autoSelectCID2,"waiting")},0)}M.updateTextFields(),$("#commands").css("height","auto"),setTimeout(function(){M.textareaAutoResize($("#commands"))},200),$(".tooltipped").tooltip(),$("select").formSelect(),$(".modal").modal(),$(".dropdown-trigger").dropdown(),n(!1),u()})}(),function(){var e=0;$("#easterEgg").click(async function(){e++,e>5&&(window.alert("Me: > typeof NaN\nJavascript: number"),e=0)})}();